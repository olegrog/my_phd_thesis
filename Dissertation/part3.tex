\chapter{Классические задачи молекулярной газодинамики} \label{chapt:problems}

%%% Линеализованные течения
В трудах Киотской группы реализована масштабная программа высокоточного численного анализа
классических задач молекулярной газодинамики на основе линеаризованного уравнения Больцмана
для газа твёрдых сфер~\cite{Sone2002, Sone2007}.
В настоящем исследовании рассмотрены некоторые из них при тех же предположениях,
но в существенно нелинейной постановке.
В представленных результатах численная погрешность макроскопических переменных
порядка \(10^{-4}\) по абсолютному значению.
Для течения Куэтта она не превышает \(10^{-4}\).

%%% Гидродинамические солверы
Для численного решения уравнений гидродинамического типа используются солверы,
написанные в рамках вычислительной платформы OpenFOAM~\cite{openfoam}.
В частности, разработан солвер уравнений КГФ~\cite{Rogozin2014} на основе метода конечных объёмов
и модифицированного алгоритма SIMPLE~\cite{SIMPLE}.

%%% Кинетические солверы
Для численного решения уравнения Больцмана используется программный комплекс
анализа газокинетических процессов, разработанный автором в составе коллектива
кафедры моделирования ядерных процессов и технологий факультета общей и прикладной физики
Московского физико-технического института (государственного университета)~\cite{Rogozin2010, Rogozin2011, Kloss2012}.
Сетки в физическом пространстве выбираются по такому же критерию,
как и при решении уравнений гидродинамического типа,
однако дополнительно сгущаются в геометрической прогрессии возле границ с диффузным отражением,
чтобы обеспечить аппроксимацию слоя Кнудсена с ошибкой не более \(10^{-4}\).
Сетки в скоростном пространстве выбираются как равномерные, так и неравномерные,
причём начальная функция распределения при моделировании на подробной сетке берётся
как результат моделирования на грубой сетке.
Множество кубатурных точек везде подбирается так, чтобы \(\epsilon_J < 10^{-5}\).

\section{Плоское течение Куэтта} \label{sect:couette}

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}[dashdot/.style={dash pattern=on .6pt off 1pt on 6pt off 1pt},
                interface/.style={postaction={draw, decorate, decoration=
                    {border, angle=-45, amplitude=0.3cm, segment length=2mm}}},
                label/.style={fill=white, inner sep=2pt},
                >={Stealth[scale=\mytikzscale]}, scale=\mytikzscale]
        \fill[gray!20] (0,2) -- (4,2) -- (4,4) -- (0,4) -- cycle;
        \draw[->] (-.05,2) -- (4.5,2) node[right] {\(x\)};
        \draw[->](0,-.5) -- (0,4.5) node[above] {\(y\)};
        \draw[blue, thick, interface](-.3,0) -- (4.3,0);
        \draw[blue, thick, interface](4.3,4) -- (-0.3,4);
        \draw[->] (1.4,1) node[below] {\(1+\Delta T/2\)} -- (2.3,4);
        \draw[->] (2.8,1) node[above] {\(1-\Delta T/2\)} -- (3.1,0);
        \draw[->] (2.7,4.3) -- (3.5,4.3) node[midway,above] {\(\Delta v/2\)};
        \draw[<-] (2.7,-.3) -- (3.5,-.3) node[midway,below] {\(\Delta v/2\)};
        \node at (-.02,-.02) [below left, label] {\(-0.5\)};
        \node at (-.02,4.02) [above left, label] {\(0.5\)};
        \node at (-.05,2) [left, label] {\(0\)};
    \end{tikzpicture}
    \caption{Геометрия задачи плоского течения Куэтта}\label{fig:couette}
\end{figure}

Рассмотрим одноатомный идеальный газ, заключённый между двумя бесконечными параллельными пластинами
с постоянной и одинаковой (\(\Delta{T}=0\)) температурой, принятой за единичную (рис.~\ref{fig:couette})
За счёт их движения относительно друг друга с продольной скоростью (вдоль оси \(x\))
формируется плоское течение Куэтта.
Ось \(y\) нормальна к пластинам, удалённым друг от друга на единичное расстояние,
так что координаты пластин равны \(y=\pm1/2\), а их скорости \(\pm\Delta{v}/2\).
В такой постановке задача антисимметрична, поэтому расчётная область заключена в интервал \(0<y<1/2\).
На пластине \(y=1/2\) ставятся граничные условия диффузного отражения:
\begin{equation}\label{eq:couette:diffuse_bc}
    f(\zeta_x,\zeta_y,\zeta_z) = \frac2{\pi} \exp\left[-\left(\zeta_x-\frac{\Delta{v}}{2}\right)^2-\zeta_y^2-\zeta_z^2\right]
        \int_{\zeta_{*y}>0}\zeta_{*y} f_* \dzeta_*, \quad \zeta_y<0,
\end{equation}
а на границе \(y=0\) условие антисимметричности:
\begin{equation}\label{eq:couette:antisymmetry_bc}
    f(\zeta_x,\zeta_y,\zeta_z) = f(-\zeta_x,-\zeta_y,\zeta_z), \quad \zeta_y>0.
\end{equation}
Плотность нормируется так, чтобы
\begin{equation}\label{eq:total_mass}
    \int_{-\frac12}^\frac12\rho\dd{y} = 1.
\end{equation}

Течение Куэтта линеаризуется при \(\Delta{v}\ll 1\),
тогда искомое решение может быть найдено в форме
\begin{equation}\label{eq:couette:linear_solution}
    \phi = \Delta{v} \zeta_x \Phi(y,\zeta_y,\zeta), \quad \zeta = \sqrt{\zeta_i^2},
\end{equation}
Подставляя~\eqref{eq:couette:linear_solution} в~\eqref{eq:linear_Boltzmann}, получаем
\begin{equation}\label{eq:couette:linear_equation}
    \zeta_y \pder[\Phi]{y} = \frac1{k\zeta_x}\mathcal{L}(\zeta_x\Phi)
\end{equation}
со следующими граничными условиями:
\begin{equation}\label{eq:couette:linear_bc}
    \Phi_-(1/2,\zeta_y,\zeta) = 1, \quad \Phi_+(0,\zeta_y,\zeta) = -\Phi_-(0,-\zeta_y,\zeta),
\end{equation}
где \(\Phi_\pm = \Phi(\zeta_y \gtrless 0)\).
Возмущенные макроскопические переменные
\begin{equation}\label{eq:couette:linear_macro}
    \frac{P_{xy}}{\Delta{v}} = 2\int \zeta_x^2 \zeta_y \Phi E\dzeta, \quad
    \frac{v_x}{\Delta{v}} = \int \zeta_x^2 \Phi E\dzeta, \quad
    \frac{q_x}{\Delta{v}} = \int \zeta_x^2 \zeta^2 \Phi E\dzeta - \frac52 \frac{v_x}{\Delta{v}}.
\end{equation}

\subsection{Методы решения линейной задачи}

При \(k\to\infty\) мы получаем бесстолкновительное линеаризованное уравнение Больцмана \(\zeta_y\Pder[\Phi]{y} = 0\),
которое имеет простое решение в виде комбинации двух антисимметричных полумаксвеллов \(\Phi_\pm = \mp 1\), что даёт
\begin{gather}\label{eq:couette:linear_free_macro}
    \frac{P_{xy}}{\Delta{v}} = -\frac1{\sqrt{\pi}}, \quad v_x = q_x = 0.
\end{gather}

При малых \(k\) можно построить решение Грэда"--~Гильберта
\begin{equation}\label{eq:couette:small_solution}
    \Phi = \frac{2y - \zeta_y \mathcal{B}(\zeta) k}{1-2k_0k},
\end{equation}
где \(\mathcal{B}(\zeta)\) определена в~\eqref{eq:gh:B}.
Тогда макроскопические переменные равны
\begin{equation}\label{eq:couette:small_macro}
    \frac{P_{xy}}{\Delta{v}} = - \frac{\gamma_1 k}{1-2k_0k}, \quad
    \frac{v_x}{\Delta{v}} = \frac{y - (Y_0^--Y_0^+)k}{1-2k_0k}, \quad
    \frac{q_x}{\Delta{v}} = \frac{(H_A^--H_A^+)k}{1-2k_0k},
\end{equation}
где функции кнудсеновского слоя \(K^\pm = Y_0^\pm, H_A^\pm\):
\begin{equation}\label{eq:couette:linear_knudsen_functions}
     K^\pm = K(\eta_\pm), \quad \eta_\pm = \frac{1 \mp 2y}{2k}.
\end{equation}
Асимптотическое решение предполагает, что слои Кнудсена обеих пластин не пересекаются.

При произвольных \(k\) решение может быть получено путём численного анализа.
С высокой точностью эта задача была решена Киотской группой для газа твёрдых сфер~\cite{Ohwada1990}.
Для сравнения рассмотрим также решение модельного уравнения Крука"--~Веландера,
у которого столкновительный член в линеаризованной форме
\begin{equation}\label{eq:linear_bkw}
    \mathcal{L}(\phi) = -\phi + \omega + 2\zeta_i v_i + \left(\zeta_i^2-\frac32\right)\tau
\end{equation}
приводит к
\begin{equation}\label{eq:couette:linear_bkw_equation}
    \zeta_y \pder[\Phi]{y} = \frac1{k}\left( \frac{2v_x}{\Delta{v}} - \Phi \right).
\end{equation}
Решение~\eqref{eq:couette:linear_bkw_equation} может быть записано в следующем виде~\cite{Willis1962}:
\begin{equation}\label{eq:couette:bkw_solution}
    \Phi_\pm = \mp \exp\left(\mp\frac{\eta_\mp}{\zeta_y}\right) +
        \int_{\mp\frac12}^y \frac1{k\zeta_y} \exp \left(-\frac{y-s}{k\zeta_y}\right) g(s) \dd{s},
\end{equation}
где \(g(y) = 2v_x/\Delta v\) находится из интегрального уравнения Фредгольма второго рода
\begin{multline}\label{eq:couette:bkw_g_equation}
    \sqrt{\pi} g(y) = \mathcal{T}_0 \left(\frac{1-2y}{2k}\right) - \mathcal{T}_0 \left(\frac{1+2y}{2k}\right) \\
        + \frac1k \int_0^{\frac12} \left[ \mathcal{T}_{-1}\left(\frac{|y-s|}{k}\right)
        - \mathcal{T}_{-1}\left(\frac{y+s}{k}\right) \right] g(s) \dd{s},
\end{multline}
где \(\mathcal{T}_n(s)\) "--- специальные функции Абрамовица~\cite{Abramowitz1972}:
\begin{equation}\label{eq:Abramowitz}
    \mathcal{T}_n(s) = \int_0^\infty t^n \exp\left(-t^2-\frac{s}{t}\right) \dd t,
    \quad s\ge0, \quad n \in \mathbb{Z}.
\end{equation}
Ядро уравнения~\eqref{eq:couette:bkw_solution} содержит слабую сингулярность,
поэтому для получения высокоточного решения необходимо использовать некоторые специальные методы~\cite{Luo2015, Luo2016}.
Остальные макроскопические переменные вычисляются следующим образом:
\begin{gather}
    \frac{P_{xy}}{\Delta v} = -\frac{2k}{\sqrt{\pi}} \left(
        \mathcal{T}_2(0)-\mathcal{T}_2\left(\frac1k\right)
        + \frac1k\int_0^{\frac12}\left[
            \mathcal{T}_1\left(\frac{1-2s}{2k}\right)-\mathcal{T}_1\left(\frac{1+2s}{2k}\right)
        \right]g(s)\dd{s}
        \right), \label{eq:couette:bkw_macro_Pxy} \\
    \begin{aligned}
    \frac{q_x}{\Delta v} = \frac1{2\sqrt{\pi}}&\left(
        \mathcal{T}_2\left(\frac{1-2y}{2k}\right) - \mathcal{T}_2\left(\frac{1+2y}{2k}\right)\right. \\
        &+\left. \frac1k\int_0^{\frac12}\left[
            \mathcal{T}_1\left(\frac{|y-s|}k\right)-\mathcal{T}_1\left(\frac{y+s}k\right)
        \right]g(s)\dd{s}
        \right) - \frac{g(y)}4.
    \end{aligned} \label{eq:couette:bkw_macro_qx}
\end{gather}

\subsection{Методы решения нелинейной задачи}

В настоящем исследовании для решения нелинейной задачи используется как численное решение КПИМДС,
так и асимптотическое.
Для верификации полученных результатов дополнительно используются другие известные методы,
перечисленные коротко ниже.

\subsubsection{Свободномолекулярный предел}

Бесстолкновительное уравнение Больцмана, как и в линеаризованном случае,
имеет решение в виде комбинации двух антисимметричных полумаксвеллианов
\begin{equation}\label{eq:couette:free_solution}
    f^\pm = f(\zeta_y \gtrless 0) =
        \frac1{\pi\sqrt{\pi}} \exp\left[-\left(\zeta_x\pm\frac{\Delta{v}}2\right)^2 - \zeta_y^2 - \zeta_z^2\right],
\end{equation}
дополняющее уравнения~\eqref{eq:couette:linear_free_macro} следующими соотношениями:
\begin{equation}\label{eq:couette:free_macro}
    \frac{\tau}{(\Delta{v})^2} = \frac16, \quad q_y = 0, \quad
    \frac{P_{xx}}{(\Delta{v})^2} = \frac12, \quad P_{yy} = P_{zz} = 0.
\end{equation}

\subsubsection{Уравнения Навье"--~Стокса}\label{sec:Navier-Stokes}

Для задачи течения Куэтта уравнения сохранения вырождаются в
\begin{equation}\label{eq:couette:conservation_laws}
    \pder[p]{y} = 0, \quad \pder[p_{xy}]{y} = 0, \quad \pder{y}(v_x p_{xy} + q_y) = 0.
\end{equation}
Подставляя законы Ньютона и Фурье,
\begin{equation}\label{eq:couette:Newton-Fourier}
    p_{xy} = -\gamma_1 k\sqrt{T}\pder[v_x]{y}, \quad q_y = -\frac54\gamma_2 k\sqrt{T}\pder[T]{y},
\end{equation}
в~\eqref{eq:couette:conservation_laws}, получаем систему дифференциальных уравнений
\begin{equation}\label{eq:couette:Navier-Stokes}
    \pder{y}\left(\sqrt{T}\pder[v_x]{y}\right) = 0, \quad
    \sqrt{T}\left(\pder[v_x]{y}\right)^2 + \frac54\frac{\gamma_2}{\gamma_1}\pder{y}\left(\sqrt{T}\pder[T]{y}\right) = 0,
\end{equation}
которая обычно решается с граничными условиями без скольжения при \(y=1/2\):
\begin{equation}\label{eq:couette:nonslip_bc}
    v_x = \frac{\Delta{v}}2, \quad T = 1.
\end{equation}
Константное давление \(p\) рассчитывается по общей массе газа (см.~\eqref{eq:total_mass}):
\begin{equation}\label{eq:couette:constant_pressure}
    p = \left( 2\int_{0}^\frac12\frac{\dd{y}}{T} \right)^{-1}.
\end{equation}

\subsubsection{Прямое статистическое моделирование}

Детальное описание метода Бёрда может быть легко найдено в литературе (см., например,~\cite{Bird1994, Sone2007}).
В настоящем исследовании используется его численная реализация, солвер \verb+dsmcFoam+~\cite{dsmcfoam},
разработанный в рамках вычислительной платформы OpenFOAM.

Численное моделирование газа твёрдых сфер между двумя параллельными пластинами осуществляется
в двумерном пространстве \((x,y)\) при периодических граничных условиях вдоль оси \(y\).
Размер статистического ансамбля \(2\times10^6\) для \(\Delta{v}=0.1\)
и \(2\times10^5\) для \(\Delta{v}\ge1\).
Область физического пространства \(0<y<1/2\) разделена на равномерные участки:
от 40 для \(\Kn=10\) до 100 для \(\Kn=0.1\).
Временн\'{о}й шаг выбирается эмпирически для обеспечения удовлетворительного приближения макроскопических переменных:
\begin{equation}\label{eq:dsmc_timestep}
    \Delta{t} = \frac{\pi}2 \frac{\sqrt{\Kn}}{1000}.
\end{equation}
Для снижения статистического шума решение усредняется с течением времени после достижения устойчивого состояния.

\subsection{Решение на равномерной сетке}

\begin{figure}
    \centering
    \includegraphics{uniform/couette/graph}
    \caption{Сдвиговое напряжение, полученное КПИМДС на равномерной сетке.}
    \label{fig:couette:uniform:shear}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{uniform/couette/flow}
    \caption{Средняя скорость, полученная КПИМДС на равномерной сетке.}
    \label{fig:couette:uniform:flow}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{uniform/couette/qflow}
    \caption{Средний поток тепла, полученный КПИМДС на равномерной сетке.}
    \label{fig:couette:uniform:qflow}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{uniform/error/error}
    \caption{
        Зависимость погрешностей вычисления теплопотока для бесстолкновительного газа
        и коэффициента теплопроводности для слаборазреженного газа
        от числа узлов на радиусе равномерной скоростной сетки.
    }\label{fig:heat:error}
\end{figure}

Прежде всего необходимо продемонстрировать, насколько точное решение возможно получить,
используя равномерные сетки в скоростном пространстве.
Для этого решается линейная задача методом КПИМДС и сравнивается с известным решением.

На рис.~\ref{fig:couette:uniform:shear} показана зависимость \(p_{xy}\) от \(\Kn\), полученная различными методами.
Для бесстолкновительного газа есть превышение \(p_{xy}\) на \(0.0061\),
обусловленное квадратурной ошибкой вычисления макроскопических переменных на равномерной сетке.
При малых \(\Kn\) наблюдается отклонение коэффициентов вязкости (\(+0.0083\)) и скольжения (\(-0.012\)).

На рис.~\ref{fig:couette:uniform:flow} и \ref{fig:couette:uniform:qflow} видно, что для больших \(\Kn\)
полученное решение сильно отклоняется от истинного. Это вызвано недостаточной аппроксимацией
резкого перепада функции распределения около плоскости \(\zeta_y=0\).
Если при малых \(\Kn\) кнудсеновский слой вносит малый вклад в интегральные характеристики,
изображённые на рис.~\ref{fig:couette:uniform:flow} и \ref{fig:couette:uniform:qflow}, то с увеличением \(\Kn\)
резкий перепад решения проникает во всю область физического пространства.

Численная погрешность решения убывает со вторым порядком в зависимости от шага скоростной сетки,
что продемонстрировано в логарифмическом масштабе на рис.~\ref{fig:heat:error}.

\subsection{Решение на неравномерной сетке}

Этот раздел последовательно описывает пространственную дискретизацию задачи,
применяемые методы контроля точности, полученные решения в виде плоских сечений функции распределения
и профилей макроскопических переменных, наконец, сравнительный анализ с результатами ПСМ,
нелинейного асимптотического анализа, а также с решениями линейной задачи.

\subsubsection{Дискретизация пространства}

%%% The grid in the physical space
Расчётная область (\(0<y<1/2\)) состоит из \(N_x\) ячеек, расположенных в одном ряду.
При малых \(\Kn\) вблизи \(y=1/2\) физическая сетка измельчается так,
чтобы разрешить слой Кнудсена с достаточной точностью.

%%% The grid in the velocity
Пространство дискретных скоростей ограничено сфероидом, заполненным центрированной прямоугольной сеткой \(\mathcal{V}\).
Ось симметрии сфероида параллельна оси \(\zeta_x\).
\(\zeta^{(\mathrm{cut})}_x\) "--- большая полуось, \(\zeta^{(\mathrm{cut})}_r\) "--- малая полуось.
Функция распределения достаточно гладкая вдоль \(\zeta_x\) и \(\zeta_z\);
более того, \(\zeta_z\) компонента решения незначительно отличается от максвелловской с \(v_z=0\).
Поэтому расстояние между узлами выбирается постоянным вдоль оси \(\zeta_x\),
а вдоль оси \(\zeta_z\) узлы располагаются как корни полиномы Эрмита,
так как известно, что квадратуры Гаусса"--~Эрмита обеспечивают максимальный порядок аппроксимации
при вычислении интегралов вида \(\int h(s)\exp(-s^2)\dd{s}\).
\(\zeta_y\) координаты узлов \(\bzeta_\gamma\) отдаляются от \(\zeta_y=0\)
в геометрической прогрессии со знаменателем \(r\).
Такое измельчение сетки позволяет аппроксимировать резкий перепад около \(\zeta_y=0\)
с хорошей точностью.

\subsubsection{Контроль точности}

%%% Physical grid
Физическая сетка уточняется таким образом, что ширина краевой ячейки составляет около \(\Kn/100\).
Это условие обеспечивает точность порядка \(10^{-4}\) при аппроксимации по формуле трапеций функций Кнудсена,
таких как \(Y_0(\eta)\), \(H_A(\eta)\).
При \(\Kn=100\), когда решение практически константно в физическом пространстве,
\(N_x = 30\) достаточно для достижения той же точности.

\begin{table}
    \caption{Параметры сетки скоростей для различных \(\Delta{v}\):
        \(\zeta^{(\mathrm{cut})}_x\) "--- большая полуось сфероида расчётной области,
        \(\zeta^{(\mathrm{cut})}_r\) "--- малая полуось того же сфероида,
        \(N_{\zeta_i}\) "--- максимальное количество узлов вдоль каждой оси,
        \(|\mathcal{V}|\) "--- общее число узлов,
        \(r\) "--- знаменатель геометрической последовательности,
        \(\Delta\zeta_x\) "--- расстояние между узлами вдоль оси \(\zeta_x\),
        \(\min(\Delta\zeta_y)\) "--- минимальное расстояние между узлами вдоль оси \(\zeta_y\).}
    \label{table:velocity_grid}
    \centering
    \begin{tabular}{cccccccc}
        \(\Delta{v}\) & \(\zeta^{(\mathrm{cut})}_x\) & \(\zeta^{(\mathrm{cut})}_r\)
            & \(N_{\zeta_i}/2\) & \(|\mathcal{V}|\) & \(r\) & \(\Delta\zeta_x\) & \(\min(\Delta\zeta_y)\) \\\hline
        0.1 & 4.35 & 4.3 & (12, 26, 8)  & 15008 & 1.28 & 0.36 & 0.0020 \\
        1.0 & 4.80 & 4.5 & (14, 23, 9)  & 16872 & 1.29 & 0.34 & 0.0037 \\
        2.0 & 5.30 & 5.0 & (16, 24, 10) & 23096 & 1.28 & 0.33 & 0.0038 \\
        5.0 & 8.00 & 8.0 & (20, 26, 13) & 41520 & 1.27 & 0.40 & 0.0043 \\
    \end{tabular}
\end{table}

%%% Velocity grid
Для оценки точности дискретного приближения в пространстве скоростей
были рассмотрены две противоположные формы функции распределения.
Во-первых, 13-моментное приближение Грэда
\begin{equation}\label{eq:grad13}
    f = \frac{\rho}{(\pi T)^{3/2}}\exp\left(-\frac{c_i^2}{ T}\right)
    \left[ 1 + \frac{(p_{ij}-p\delta_{ij})c_ic_j}{pT} + \frac4{5}\frac{q_ic_i}{pT}\left(\frac{c_j^2}{T}-\frac5{2}\right) \right],
    \quad c_i = \zeta_i - v_i,
\end{equation}
используется для оценки погрешности аппроксимации гладких функций.
Во-вторых, комбинация двух разных полумаксвеллианов
\begin{equation}\label{eq:double_Maxwell}
    f(\zeta_y\gtrless0) = \frac{\rho^\pm}{(\pi T^\pm)^{3/2}}
        \exp\left(-\frac{(\zeta_x-v_x^\pm)^2+\zeta_y^2+\zeta_z^2}{T^\pm}\right)
\end{equation}
используется для моделирования разрыва при \(\zeta_y=0\).
Кроме того, при малых \(\Kn\) и больших \(\Delta{u}\) газ значительно нагревается из-за трения,
поэтому скоростная сетка должна подходить как для распределения скоростей с \(T=1\) вблизи пластины,
так и для большей температуры вблизи плоскости симметрии.
Параметры скоростной сетки, достаточные для получения точности порядка \(10^{-4}\)
представлены в табл.~\ref{table:velocity_grid}.

%%% Number of cubature points and scheme
Максимальное значение \(\epsilon_J\) наблюдается в краевой ячейке,
где \(f\) меняется сильнее около \(\zeta_y = 0\), и практически не зависит от \(\Kn\) при \(\Kn<1\).
Для б\'{о}льших \(\Kn\) \(\epsilon_J\) меньше из-за меньшего размера ячеек по отношению к длине свободного пробега.
Пока решение далеко от стационарного состояния, меньшее число кубатурных точек \(N\) используется,
чтобы ускорить процесс его достижения.
Для того чтобы уменьшить статистическую ошибку из-за случайного сдвига решётки интегрирования,
значения всех макроскопических переменных усредняются по временн\'{ы}м итерациям после достижения стационарного состояния.
Хотя для 7-точечной схемы требуется немного меньшее \(N\),
5-точечная схема используется, поскольку требует немного меньше вычислений.

%%% Remark on a time step
Стоит сделать замечание о временн\'{о}м шаге и процессе достижения стационарного состояния.
В силу условия Куранта сходимости явной схемы для уравнения переноса~\eqref{eq:split_transport},
шаг по времени имеет тот же порядок, что и размер краевой ячейки.
Поэтому для ускорения численного счёта при малых \(\Kn\),
начальная функция распределения строится как локальный максвеллиан с \(\rho\), \(v_i\) и \(T\),
полученных при решении на грубой равномерной скоростной сетке.
Более того, для самых маленьких \(\Kn\), решение не достигает стационарного состояния полностью.
Итерационный процесс останавливается, когда амплитуда волновых колебаний уменьшается до \(10^{-4}\),
после чего решение экстраполируется для оценки установившихся профилей макроскопических переменных.
Чтобы достичь стационарного состояния для самых больших \(\Kn\), требуется также много временн\'{ы}х шагов.

\subsubsection{Полученные результаты}

\begin{figure}
    \centering
    \subbottom[\(\Kn=0.1\) и \(y=0.4990\)]{%
        \includegraphics[width=.48\textwidth]{{{couette/distrib_f/kn0.1-boundary}}}
        \label{fig:distrib-kn0.1:boundary}}
    \subbottom[\(\Kn=0.1\) и \(y=0.0082\)]{%
        \includegraphics[width=.48\textwidth]{{{couette/distrib_f/kn0.1-center}}}
        \label{fig:distrib-kn0.1:center}}\\
    \subbottom[\(\Kn=1\) и \(y=0.4929\)]{%
        \includegraphics[width=.48\textwidth]{{{couette/distrib_f/kn1.0-boundary}}}
        \label{fig:distrib-kn1.0:boundary}}
    \subbottom[\(\Kn=1\) и \(y=0.0083\)]{%
        \includegraphics[width=.48\textwidth]{{{couette/distrib_f/kn1.0-center}}}
        \label{fig:distrib-kn1.0:center}}\\
    \subbottom[\(\Kn=10\) и \(y=0.4917\)]{%
        \includegraphics[width=.48\textwidth]{{{couette/distrib_f/kn10-boundary}}}
        \label{fig:distrib-kn10:boundary}}
    \subbottom[\(\Kn=10\) и \(y=0.0083\)]{%
        \includegraphics[width=.48\textwidth]{{{couette/distrib_f/kn10-center}}}
        \label{fig:distrib-kn10:center}}
    \caption{Контурные графики функции распределения скоростей для \(\Delta{v}=2\).
        Показано поперечное сечение \(\zeta_z=0.1665\).}
    \label{fig:distrib}
\end{figure}

На рис.~\ref{fig:distrib} показаны двумерные поперечные сечения функций распределения при \(\Delta{v}=2\).
Они получены без дополнительного усреднения по времени,
поэтому можно заметить небольшие колебания вблизи \(\zeta_y=0\)
(например, на рис.~\ref{fig:distrib-kn1.0:boundary}).
%%% the distribution function at the boundary
Вблизи границы с диффузным отражением функция распределения напоминает комбинацию двух полумаксвеллианов
как для малых \(\Kn\) (рис.~\ref{fig:distrib-kn0.1:boundary}),
так и больших (рис.~\ref{fig:distrib-kn10:boundary}).
Видно, что распределение молекулярных скоростей, движущихся к пластине (\(\zeta_y>0\))
имеет более высокую температуру, чем распределение движущихся от неё молекул (\(\zeta_y<0\)).
В промежуточном случае распределение скоростей больше всего отличается от максвелловского,
а тепловой поток к пластине максимален (рис.~\ref{fig:distrib-kn1.0:boundary}).
%%% the distribution function at the symmetry plane
Вблизи плоскости симметрии вид функции распределения значительно меняется в зависимости от \(\Kn\).
Для малых \(\Kn\) он близок к состоянию равновесия (рис.~\ref{fig:distrib-kn0.1:center}).
С ростом \(\Kn\) возникает седловая точка \(\zeta_i=0\) (рис.~\ref{fig:distrib-kn1.0:center}).
Для больших \(\Kn\) решение несильно отличается от распределения скоростей на границе
\(y=1/2\) (рис.~\ref{fig:distrib-kn10:center}).

\begin{figure}
    \subbottom[напряжение сдвига]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/Pxy}
        \label{fig:couette:profile:Pxy}}
    \subbottom[продольная скорость]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/vx}
        \label{fig:couette:profile:vx}}\\
    \subbottom[продольный поток тепла]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/qx}
        \label{fig:couette:profile:qx}}
    \subbottom[поперечный поток тепла]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/qy}
        \label{fig:couette:profile:qy}}\\
    \subbottom[давление]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/P}
        \label{fig:couette:profile:P}}
    \subbottom[поперечная часть давления]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/Pyy}
        \label{fig:couette:profile:Pyy}}
    \caption{Профили макроскопических переменных в плоском течении Куэтта.}
\end{figure}
\begin{figure}
    \contsubbottom[продольная часть давления]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/Pxx}
        \label{fig:couette:profile:Pxx}}
    \contsubbottom[оставшаяся часть давления]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/Pzz}
        \label{fig:couette:profile:Pzz}}\\
    \contsubbottom[отклонение температуры]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/tau}
        \label{fig:couette:profile:tau}}
    \contsubbottom[отклонение плотности]{%
        \includegraphics[width=.48\textwidth]{couette/profiles/omega}
        \label{fig:couette:profile:omega}}
    \contcaption{(продолжение) Профили макроскопических переменных в плоском течении Куэтта.}
    \label{fig:couette:profiles}
\end{figure}

На рис.~\ref{fig:couette:profiles} показаны профили макроскопических переменных.
Отметим некоторые их особенности. Из-за роста давления газа относительное скольжение газа вдоль пластины
уменьшается с увеличением его скорости (см.~также асимптотическое решение~\eqref{eq:1d:v}).
Таким же образом уменьшается и скачок температуры.
В линейном случае продольный вектор теплового потока \(q_x\) представлен только в слое Кнудсена,
но из-за сильной анизотропии функции распределения при больших \(\Delta{v}\)
его объёмная составляющая увеличивается быстрее, чем \((\Delta{v})^2\).
Поэтому кривизна профиля \(q_x\) меняет свой знак с увеличением \(\Delta{v}\).
Асимптотическое решение описывает то же самое поведение \(q_x\) (см.~\eqref{eq:1d:q_x}).
Благодаря значительному нагреву газа при больших \(\Delta{v}\),
вектор поперечного потока тепла \(q_y\) также растёт быстрее, чем \((\Delta{v})^2\),
но кривизна профиля сохраняет свой знак.
Более того, для большинства \(\Delta{v}\) и \(\Kn\) \(q_x\) превалирует над \(q_y\).
Продольное напряжение \(P_{xx}\) всегда больше, чем \(P_{yy}\) и \(P_{zz}\).
В слое Кнудсена при малых \(\Kn\), постоянное напряжение \(P_{yy}\) становится больше, чем \(P_{zz}\).
Напомним, что \(P_{ij}\) не тензор сдвиговых напряжений, а возмущенный тензор напряжений
(см.~\eqref{eq:linear_macro_variables}).
Средняя температура газа увеличивается с ростом \(\Kn\),
потому что более разреженный газ имеет более низкую теплопроводность.

\subsubsection{Сравнение результатов}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/shear}
    \caption{Зависимость сдвигового напряжения от числа Кнудсена.}
    \label{fig:couette:shear}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/flow}
    \caption{Зависимость продольного массового расхода от числа Кнудсена.}
    \label{fig:couette:flow}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/qflow}
    \caption{Зависимость продольного теплового потока от числа Кнудсена.}
    \label{fig:couette:qflow}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/qflowy}
    \caption{Зависимость поперечного теплового потока от числа Кнудсена.}
    \label{fig:couette:qflowy}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/pxx}
    \caption{Зависимость разности \(P_{xx}-P_{yy}\) от числа Кнудсена.}
    \label{fig:couette:pxx}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/pzz}
    \caption{Зависимость разности \(P_{zz}-P_{yy}\) от числа Кнудсена.}
    \label{fig:couette:pzz}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/temp}
    \caption{Зависимость отклонения температуры от числа Кнудсена.}
    \label{fig:couette:temp}
\end{figure}

\begin{figure}
    \centering
    \includegraphics{couette/integrated/diff}
    \caption{Абсолютная разница \(|\int_0^{1/2} (h^{(1)}-h^{(2)})\dd{y}|\),
        где \(h = P_{xy}, q_x, \tau\), а верхний индекс обозначает метод, в зависимости от числа Кнудсена:
        линии без кругов соответствуют разнице между асимптотическим и КПИМДС решениями,
        линии с кругами соответствуют разнице между решениями, полученными методом Бёрда и КПИМДС.}
    \label{fig:couette:diff}
\end{figure}

На рис.~\ref{fig:couette:shear}--\ref{fig:couette:temp} показаны макроскопические переменные,
интегрированные по половине объёма между пластинами \(0<y<1/2\), в зависимости от числа Кнудсена.
Чтобы наглядно отобразить разницу между результатами, мы вычитаем асимптотические решения
в двух противоположных пределах (\(\Kn\to0\) и \(\Kn\to\infty\)) и используем логарифмическую шкалу.
Величины со звездочкой вычисляются по уравнениям Навье"--~Стокса~\eqref{eq:Navier-Stokes}
с граничными условиями без скольжения~\eqref{eq:couette:nonslip_bc}:
\begin{gather*}
    P_{\NS xy}^* = \frac1k \int_0^\frac12 P_{xy} \dd{y}, \quad P_{\NS xy} = P_{\NS xy}^*(\Delta{v}\to0) = -\gamma_1\frac{\Delta{v}}2, \\
    v_{\NS x}^* = \int_0^\frac12 v_x \dd{y}, \quad v_{\NS x} = v_{\NS x}^*(\Delta{v}\to0) = \frac{\Delta{v}}8, \\
    \tau_{\NS}^* = \int_0^\frac12 \tau \dd{y}, \quad
        \tau_{\NS} = \tau_{\NS}^*(\Delta{v}\to0) = \frac{\gamma_1}{\gamma_2}\frac{(\Delta{v})^2}{30}.
\end{gather*}
Их числовые значения показаны в табл.~\ref{table:NS_params}.

\begin{table}
    \centering
    \caption{Величины, полученные из численного решения уравнений Навье"--~Стокса.}
    \label{table:NS_params}
    \begin{tabular}{cccc}
        \(\Delta{v}\) & \(\displaystyle P_{\NS xy}^*/P_{\NS xy}\) & \(\displaystyle v_{\NS x}^*/v_{\NS x}\) & \(\displaystyle \tau_{\NS}^*/\tau_{\NS}\) \\[3pt]
        0.1 & 1.000220 & 0.999945 & 1.000049 \\
          1 & 1.021740 & 0.994715 & 1.004237 \\
          2 & 1.083898 & 0.981103 & 1.015173 \\
          5 & 1.438344 & 0.931106 & 1.055818 \\
    \end{tabular}
\end{table}

На рис.~\ref{fig:couette:shear}--\ref{fig:couette:qflow} показаны макроскопические переменные,
не равные нулю в линеаризованной задаче.
При малых \(\Delta{v}\) верификация результатов может быть основана на сравнении с точным численным решением
линеаризованного уравнения Больцмана~\cite{Ohwada1990} (чёрная линия).
В отличие от метода Бёрда численные флуктуации КПИМДС уменьшаются, когда задача приближается к линейному случаю
(благодаря интерполяции~\eqref{eq:geom_interpolation}).

Для сравнения с решением уравнения Крука"--~Веландера (голубая линия)
\(k\) заменяется в~\eqref{eq:couette:bkw_solution} следующими величинами:
\(\gamma_1k\) для рис.~\ref{fig:couette:shear} и~\ref{fig:couette:flow}, \(\gamma_2k\) для рис.~\ref{fig:couette:qflow}.
При такой модификации коэффициенты вязкости и теплопроводности модели Крука"--~Веландера
совпадают с твердосферными, поскольку для неё \(\gamma_1=\gamma_2=1\).

На рис.~\ref{fig:couette:shear} и рис.~\ref{fig:couette:qflow} видно,
что разница между асимптотическим решением (синяя линия) и КПИМДС (красная линия) является \(\OO{\Kn^3}\).
Это находится в соответствии с выражениями~\eqref{eq:1d:p_xy} и~\eqref{eq:1d:q_x}.
При \(\Delta{v}=0.1\), асимптотическое решение близко к линейному~\eqref{eq:couette:linear_macro},
которое имеет больший порядок аппроксимации.
На рис.~\ref{fig:couette:flow} отклонение кривых КПИМДС от асимптотического решения при малых \(\Kn\)
указывает на то, что погрешность, достигнутая КПИМДС, находится в интервале от \(10^{-5}\) до \(10^{-4}\).
Это утверждение более наглядно на рис.~\ref{fig:couette:diff},
где абсолютная разница между решениями изображена для некоторых макроскопических переменных.
Увеличение ошибки для \(\tau\) и \(v_x\) для самых маленьких \(\Kn\)
обусловлено недостаточным количеством временн\'{ы}х итераций, выполненных во время моделирования.
Другими словами, стационарное состояние не достигается полностью.

Метод Бёрда (зелёная линия) демонстрирует погрешность в интервале от \(10^{-4}\) до \(10^{-3}\),
главным образом из-за высокой дисперсии статистического шума, особенно при \(\Delta{v}=0.1\).
На рис.~\ref{fig:couette:shear} заметна разность с постоянным знаком между решениями,
полученными методом Бёрда и КПИМДС.
Она может быть уменьшена при устремлении шага по времени к нулю.
Меньший временн\'{о}й шаг намеренно не используется в настоящем расчёте DSMC,
чтобы проиллюстрировать, что даже такой небольшой временной шаг как~\eqref{eq:dsmc_timestep}
может оказаться недостаточным для достижения решения высокой точности.
Между прочим, другие величины, рассчитанные методом Бёрда, практически не меняются
с дальнейшим уменьшением временн\'{о}го шага.

На рис.~\ref{fig:couette:qflowy}--\ref{fig:couette:temp} показаны макроскопические переменные,
возникающие как квадрат от \(\Delta{v}\).
Результаты для \(\Delta{v}=0.1\) опущены из-за низкой точности.
Разница между решениями, полученными асимптотическим методом и КПИМДС,
является \(\OO{\Kn^3}\) на рис.~\ref{fig:couette:qflowy}--\ref{fig:couette:pzz}
и \(\OO{\Kn^2}\) на рис.~\ref{fig:couette:temp}.
Принимая во внимание соответствующую точность отдельных подходов,
все представленные результаты находятся в полном согласии.

%\newpage
%============================================================================================================================
\section{Течение между пластинами с синусоидальным распределением температур} \label{sect:sone_bobylev}

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}[dashdot/.style={dash pattern=on .6pt off 1pt on 6pt off 1pt},
                interface/.style={postaction={draw, decorate, decoration=
                    {border, angle=-45, amplitude=0.3cm, segment length=2mm}}},
                label/.style={fill=white, inner sep=2pt},
                >={Stealth[scale=\mytikzscale]}, scale=\mytikzscale]
        \fill[gray!20] (0,0) -- (2,0) -- (2,2) -- (0,2) -- cycle;
        \draw[->] (-.5,0) -- (4.5,0) node[right] {\(x\)};
        \draw[->](0,-.5) -- (0,4.5) node[above] {\(z\)};
        \draw(4,-.5) -- (4,4.5);
        \draw[dashdot] (-.2,2) -- (4.2,2);
        \draw[dashdot] (2,-.2) -- (2,4.2);
        \draw[red, very thick] (-.5,-.2) sin (0,-.3) cos (1,0) sin (2,.3) cos (3,0) sin (4,-.3) cos (4.5,-.2);
        \draw[red, very thick] (-.5,3.8) sin  (0,3.7) cos (1,4) sin (2,4.3) cos (3,4) sin (4,3.7) cos (4.5,3.8);
        \draw[blue, thick, interface](-.3,0) -- (4.3,0);
        \draw[blue, thick, interface](4.3,4) -- (-0.3,4);
        \draw[<->] (4.1,3.7) -- (4.4,3) node[right] {\(T_B(x)\)} -- (2.55,.2);
        \node at (-.02,-.02) [below left, label] {0};
        \node at (4.02,-.02) [below right, label] {\(1\)};
        \node at (-.02,4.02) [above left, label] {\(1\)};
        \node at (-.05,2) [left, label] {\(0.5\)};
        \node at (2,-.05) [below, label] {\(0.5\)};
    \end{tikzpicture}
    \caption{Геометрия задачи}\label{fig:sone_bobylev}
\end{figure}

%%% Formulation of the problem
Рассмотрим плоскую периодическую геометрию как на рис.~\ref{fig:sone_bobylev}.
Газ расположен между двумя покоящимися (\(v_{Bi} = 0\)) бесконечными параллельными пластинами,
разделёнными на единичное расстояние. Их температура распределена по синусоидальному закону:
\begin{equation}
    T_B = 1 - \frac{\cos(2\pi x)}{2}.
\end{equation}
Плотность газа нормирована на единицу~\eqref{eq:total_mass}.
В силу симметрии задачи расчётная область представляет собой квадрат со стороной \(1/2\).
На рис.~\ref{fig:sone_bobylev} она выделена серым цветом.

%%% Aim of the study
Эта задача изучалась в~\cite{Sone1996} как с помощью уравнений КГФ, так и на основе кинетического подхода,
однако из-за высокой сложности численного решения уравнения Больцмана использовалось уравнение Крука"--~Веландера.
Некоторые результаты моделирования смеси газов для рассматриваемой геометрии можно найти в~\cite{Wu2015}.
В настоящем исследовании получено прямое решение уравнения Больцмана для газа твёрдых сфер.
Кроме того, в рамках задачи рассматривается асимптотическое решение для малых \(\Kn\),
основанное на граничных условиях с учётом дополнительных членов старшего порядка.

\subsubsection{Решение задачи в континуальном пределе}

\begin{figure}
    \centering
    \subbottom[уравнение теплопроводности~\eqref{eq:heat_equation}]{%
        \includegraphics[width=.48\textwidth]{snit/contours/heat-0-temp}
        \label{fig:continuum:temp-heat}}
    \subbottom[уравнения КГФ]{%
        \includegraphics[width=.48\textwidth]{snit/contours/asym-0-temp}
        \label{fig:continuum:temp-snit}}
    \caption{Изотермические линии в континуальном пределе}
    \label{fig:continuum:temp}
\end{figure}

\begin{figure}
    \centering
    \subbottom[уравнения КГФ без скольжения (\(K_1=0\))]{%
        \includegraphics[width=.48\textwidth]{snit/contours/nonslip-0-vel}
        \label{fig:continuum:flow-nonslip}}
    \subbottom[уравнения КГФ]{%
        \includegraphics[width=.48\textwidth]{snit/contours/asym-0-vel}
        \label{fig:continuum:flow-snit}}
    \caption{Стационарное поле \(v_{i1}\) в континуальном пределе:
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
    \label{fig:continuum:flow}
\end{figure}

%%% Space discretization
Для численного решения поставленной задачи в физическом пространстве
используется следующая прямоугольная сетка:
область \(0<x<1/2\) разбивается на 30 интервалов одинаковой длины,
а область \(0<y<1/2\) на 40 интервалов, сгущающихся к \(y=0\).

%%% Results and discussions
На рис.~\ref{fig:continuum:temp} показано стационарное температурное поле,
получаемое как при решении уравнения теплопроводности, так и уравнений КГФ.
В континуальном пределе уравнение теплопроводности получается из уравнений КГФ,
если положить \(\Gamma_7=0\) и \(K_1=0\).
Эффект теплового скольжения газа значительно превышает влияние нелинейной термострессовой конвекции,
что продемонстрировано на рис.~\ref{fig:continuum:flow}, где уравнения КГФ решены
для граничных условий со скольжением и без.
Отметим также, что направления течения газа противоположны на рис.~\ref{fig:continuum:flow-nonslip}
и~\ref{fig:continuum:flow-snit}.
Полученные результаты в континуальном пределе совпадают с представленными в~\cite{Sone1996}.
Этот факт может служить верификацией используемого солвера \verb+snitSimpleFoam+.

\subsubsection{Решение для произвольных чисел Кнудсена}

\setlength{\tabcolsep}{4pt}
\begin{table}
    \caption{Параметры сеток в скоростном пространстве:
        \(\zeta_{\mathrm{cut}}\) "--- радиус сферы, в которой помещаются все узлы сетки,
        \(N_i\) "--- максимальное количество узлов вдоль оси \(\zeta_i\),
        \(|\mathcal{V}|\) "--- полное число узлов,
        \(\min\Delta\zeta_i\) "--- минимальное расстояние между узлами вдоль оси \(\zeta_i\),
        \(\delta T_M/T\) "--- относительная невязка температуры максвеллиана,
        \(\delta T_{MM}/T\) "--- относительная невязка температуры суммы двух полумаксвеллианов,
        разделённых плоскостью \(\zeta_y=0\).}
    \label{table:velocity_grids}
    \centering
    \footnotesize
    \begin{tabular}{ccccccccc}
        Сетка & \(\zeta_{\mathrm{cut}}\) & \(N_{x,z}/2\) & \(N_y/2\) & \(|\mathcal{V}|\)
            & \(\min\Delta\zeta_{x,z}\) & \(\min\Delta\zeta_y\) & \(\delta T_M/T\) & \(\delta T_{MM}/T\) \\\hline
        M1 & 4.25 & 8  & 8  & 2176  & 0.53 & 0.53  & \([-20,0.3]\cdot10^{-5}\)   & \(-[4.0,10]\cdot10^{-5}\) \\
        M2 & 5.3  & 11 & 26 & 20248 & 0.4  & 0.005 & \([2.3,4.1]\cdot10^{-5}\)   & \([2.7,4.0]\cdot10^{-5}\) \\
        M3 & 4.5  & 12 & 15 & 15568 & 0.05 & 0.005 & \([4.0,5.1]\cdot10^{-3}\)   & \([4.4,5.5]\cdot10^{-3}\) \\
        M4 & 8.0  & 16 & 16 & 28640 & 0.1  & 0.1   & \([1.65,1.79]\cdot10^{-3}\) & \([3.1,3.4]\cdot10^{-3}\) \\
    \end{tabular}
\end{table}

\begin{figure}
    \centering
    \subbottom[уравнения КГФ с граничными условиями второго порядка]{%
        \includegraphics[width=.48\textwidth]{{{snit/contours/asym-0.01-temp}}}
        \label{fig:kn0.01:temp-snit}}
    \subbottom[уравнение Больцмана]{%
        \includegraphics[width=.48\textwidth]{{{snit/contours/kes-0.01-temp}}}
        \label{fig:kn0.01:temp-exact}}
    \caption{Изотермические линии для \(\Kn=0.01\)}
    \label{fig:kn0.01:temp}
\end{figure}

\begin{figure}
    \centering
    \subbottom[уравнения КГФ с граничными условиями второго порядка]{%
        \includegraphics[width=.48\textwidth]{{{snit/contours/asym-0.01-vel}}}
        \label{fig:kn0.01:flow-snit}}
    \subbottom[уравнение Больцмана]{%
        \includegraphics[width=.48\textwidth]{{{snit/contours/kes-0.01-vel}}}
        \label{fig:kn0.01:flow-exact}}
    \caption{Стационарное поле скоростей для \(\Kn=0.01\):
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
    \label{fig:kn0.01:flow}
\end{figure}

\begin{figure}
    \centering
    \subbottom[изотермические линии]{%
        \includegraphics[width=.48\textwidth]{{{snit/contours/kes-0.1-temp}}}
        \label{fig:kn0.1:temp}}
    \subbottom[поле скоростей]{%
        \includegraphics[width=.48\textwidth]{{{snit/contours/kes-0.1-vel}}}
        \label{fig:kn0.1:flow}}
    \caption{Решение уравнения Больцмана для \(\Kn=0.1\)}
    \label{fig:kn0.1}
\end{figure}

%%% Physical grid
Для рассмотрения задачи в произвольном диапазоне чисел Кнудсена необходимо
обратиться к численному решению уравнения Больцмана.
В физическом пространстве использовалась такая же разностная сетка,
как и при решении уравнений гидродинамического типа,
однако в слое Кнудсена (вблизи \(y=0\)) она дополнительно сгущалась так,
что ширина приграничной ячейки равнялась \(0.02\) от длины свободного пробега.

%%% Velocity grid
Для контроля точности в скоростном пространстве использовались несколько сеток (M1, M2, M3),
параметры которых представлены в табл.~\ref{table:velocity_grids}.
Сначала задача решалась на грубой равномерной прямоугольной сетке M1,
после чего результат уточнялся на неравномерных сетках.
В прямоугольной сетке M2 узлы вдоль осей \(\zeta_x\) и \(\zeta_z\) располагались как корни полинома Эрмита,
а вдоль оси \(\zeta_y\) сгущались в геометрической прогрессии,
чтобы адекватно аппроксимировать сильный перепад функции распределения в слое Кнудсена.
В прямоугольной сетке M3 расстояние между узлами растёт квадратично вдоль каждой из осей.
В отличие от M2, холодные распределения (с температурой близкой к \(T=0.5\)) точнее аппроксимируются на M3.
Множества кубатурных точек также имели разную мощность: около \(5\cdot10^3\) для равномерной сетки
и около \(5\cdot10^4\) для неравномерной.
Кроме того, для очень малых \(\Kn\) применялась временн\'{а}я экстраполяция распределений
температуры и поля скоростей, поскольку достижение стационарного состояния вблизи \(y=1/2\)
требует слишком большого числа итераций явной схемы.

%%% Comparison of the velocity grids
При использовании неравномерных скоростных сеток необходимо учитывать не только качество аппроксимирования
функции распределения, но и точность кубатур вида~\eqref{eq:bzeta_cubature}.
Например, в последних двух столбцах табл.~\ref{table:velocity_grids} представлены диапазоны значений
невязки температуры максвеллиана \(\delta T_M\) и суммы двух полумаксвелианов \(\delta T_{MM}\)
для характерных температур и скоростей задачи.
На грубой сетке моменты функции распределения вычисляются достаточно точно,
если узлы распределены равномерно или как корни полинома Эрмита.
В противном случае необходимо использовать достаточно мелкую сетку,
как это сделано вдоль оси \(\zeta_y\) для сетки M2.
Для сетки M3 кубатура~\eqref{eq:bzeta_cubature} для температуры всегда превышает истинное значение
на величину порядка \(0.004\), что позволяет скорректировать на эту величину поле температур,
получаемое из численного решения уравнения Больцмана.
Для сетки M1 невязка температуры принимает отрицательные значения для температур близких к \(T=1.5\),
поскольку используется недостаточное значение \(\zeta_{\mathrm{cut}}\).

%%% Results and discussions
На рис.~\ref{fig:kn0.01:temp} и~\ref{fig:kn0.01:flow} изображены поля температуры и скорости
для \(\Kn=0.01\) и проводится сравнение между численным решением уравнения Больцмана
и решением уравнений КГФ для малых \(\Kn\).
Отчётливо видно, что температурное поле, полученное с использованием
граничного условия старшего порядка (рис.~\ref{fig:kn0.01:temp-snit})
существенно лучше приближает точное решение (рис.~\ref{fig:kn0.01:temp-exact})
по сравнению с температурным полем, полученным без его использования (рис.~\ref{fig:continuum:temp-snit}).

На рис.~\ref{fig:kn0.1} показаны соответствующие распределения для \(\Kn=0.1\).
С увеличением \(\Kn\) возрастают поток теплового скольжения и температурный скачок возле границы \(y=0\).
При этом область максимальной скорости газа отодвигается от пластины.

\begin{figure}
    \scalebox{0}{
        \begin{tikzpicture}
            \begin{axis}[hide axis]
                \addplot[line width=0.8, dotted](0,0);                      \label{leg:heat}
                \addplot[line width=0.8, dashed](0,0);                      \label{leg:asym0}
                \addplot[line width=0.8, dashdotted](0,0);                  \label{leg:asym1}
                \addplot[line width=0.8, solid](0,0);                       \label{leg:asym2}
                \addplot[line width=0.8, only marks, mark=o](0,0);          \label{leg:data1}
                \addplot[line width=0.8, only marks, mark=square](0,0);     \label{leg:data2}
                \addplot[line width=0.8, only marks, mark=triangle](0,0);   \label{leg:data3}
            \end{axis}
        \end{tikzpicture}
    }%
    \centering
    \subbottom[температура на пластине]{%
        \includegraphics[width=.48\textwidth]{snit/vs_kn/bottom_temp}
        \label{fig:comparison:bottomT}}
    \subbottom[скорость на пластине]{%
        \includegraphics[width=.48\textwidth]{snit/vs_kn/bottom_flow}
        \label{fig:comparison:bottomU}}\\
    \subbottom[температура на плоскости симметрии]{%
        \includegraphics[width=.48\textwidth]{snit/vs_kn/top_temp}
        \label{fig:comparison:topT}}
    \subbottom[скорость на плоскости симметрии]{%
        \includegraphics[width=.48\textwidth]{snit/vs_kn/top_flow}
        \label{fig:comparison:topU}}
    \hypersetup{hidelinks} % to prevent colorlinks
    \caption{
        Некоторые граничные интегралы в зависимости от числа Кнудсена, полученные разными методами:
        уравнение теплопроводности~\ref{leg:heat},
        уравнения КГФ с граничными условиями ведущего порядка (только тепловое скольжение)~\ref{leg:asym0},
        первого~\ref{leg:asym1} и второго~\ref{leg:asym2} порядков,
        уравнение Больцмана на сетках M1~\ref{leg:data1}, M2~\ref{leg:data2} и M3~\ref{leg:data3}.
        Планка погрешности у M3 соответствует коррекции температурного поля в соответствии
        с невязкой температуры максвеллиана.
        Планка погрешности у M1 соответствует отностительной ошибке \(3\cdot10^{-4}\).
    }
    \label{fig:comparison}
\end{figure}

%%% Comparison between solutions
Чтобы наглядно продемонстрировать сходимость численного решения уравнения Больцмана к
решению уравнений КГФ в континуальном пределе, рассмотрим некоторые интегральные величины
в зависимости от числа Кнудсена (рис.~\ref{fig:comparison}).
На рис.~\ref{fig:comparison:bottomT} отчётливо видно, что граничные условия для гидродинамических уравнений
наряду с соответствующими коррекциями кнудсеновского слоя
аппроксимируют численное решение уравнения Больцмана с заявленной точностью.
В частности, условие~\eqref{eq:kgf:boundary_T0} даёт погрешность \(\OO{k}\),
учёт температурного скачка первого порядка приводит к \(\OO{k^2}\),
добавка линейного скачка второго порядка улучшает сходимость до \(\OO{k^3}\).
Отметим, что решение, полученное на грубой равномерной сетке M1, практически совпадает с решением на M2,
а также с откорректированным решением на M3.

На рис.~\ref{fig:comparison:bottomU} такие же порядки погрешности наблюдаются.
Посколько изображено поле \(v_i/k\), то погрешность численного решения уравнения Больцмана возрастает для малых \(k\).
Решения, полученные на неравномерных сетках, сгущающихся в области разрыва функции распределения (\(y=0\)),
совпадают между собой, но отличаются на константную величину (около \(0.008\)) от решения на M1.
Таким образом, разрыв функции распределения на границе диффузного отражения и затухание этого разрыва в слое Кнудсена
вносят незначительный вклад в общее решение задачи. Для медленных течений этот факт объясняется тем,
что величина разрыва равна \(\OO{k}\). Это наблюдение позволяет считать функцию распределения достаточно гладкой
без существенных потерь в точности, а, следовательно, можно пренебречь необходимостью адаптации скоростной сетки
к геометрии задачи.

На рис.~\ref{fig:comparison:topT} и~\ref{fig:comparison:topU}, как и ожидалось, гидродинамическое решение
отличается от кинетического на \(\OO{k}\), поскольку изображены интегральные величины,
вычисляемые вдали от границы диффузного отражения.
На рис.~\ref{fig:comparison:topT} отчётливо видно, что решение уравнения Больцмана сходится
именно к решению уравнений КГФ, а не уравнения теплопроводности,
при этом скорректированное решение на M3 практически совпадает с M2, немного превышая M1 (около 0.001).
Эта разница, по-видимому, объясняется грубой аппроксимацией сетки M1.
Кроме того, на рис.~\ref{fig:comparison:topT} и~\ref{fig:comparison:topU} видно,
что граничные условия, учитывающие вторые производные, слабо влияют на решение уравнений КГФ,
однако учёт только лишь температурного и скоростного скачков позволяет значительно улучшить точность
асимптотического решения для малых \(k\).

%\newpage
%============================================================================================================================
\section{Течение между двумя равномерно нагретыми некоаксиальными цилиндрами} \label{sect:noncoaxial}

%%% State of problem
Теперь рассмотрим случай отсутствия градиента температуры на поверхности окружающих тел в покое.
Уравнения Навье-Стокса с любыми граничными условиями скольжения имеют тривиальное решение \(u_i = 0\), которое, однако,
недействительно для уравнений КГФ~\eqref{eq:kgf:asymptotic1_u},~\eqref{eq:kgf:asymptotic1_T},~\eqref{eq:kgf:asymptotic2_p}.
Как указывалось выше, даже при таких граничных условиях \emph{нелинейное термострессовое течение}
может возникнуть из-за непараллельности изотермических поверхностей (см.~\eqref{eq:kgf:parallel}).

%%% Geometry
Рассмотрим два цилиндра (или две сферы) с радиусами \(R_1 = 1\), \(R_2 = r\)
и с температурами \(T_1 = 1\), \(T_2 = 1+\tau\) соответственно.
Оси цилиндра параллельны, расстояние между ними равно \(d\) вдоль оси \(x\).

\subsubsection{Решение задачи в континуальном пределе}

\begin{figure}
    \centering
    \subbottom[цилиндры при \(\tau=4\)]{%
        \includegraphics{kgf/noncoaxial/cylinder5}
        \label{fig:cylinders-5}}\\
    \subbottom[сферы при \(\tau=4\)]{%
        \includegraphics{kgf/noncoaxial/sphere5}
        \label{fig:spheres-5}}
    \caption{Поле скорости \(u_{i1}\) между двумя некоаксиальными поверхностями:
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
\end{figure}

% allow break
\begin{figure}
    \contsubbottom[цилиндры при \(\tau=49\)]{%
        \includegraphics{kgf/noncoaxial/cylinder50}
        \label{fig:cylinders-50}}\\
    \contsubbottom[цилиндры при \(T_1=5\) и \(T_2=1\)]{%
        \includegraphics{kgf/noncoaxial/inverse5}
        \label{fig:cylinders-inv}}
    \contcaption{(продолжение) Поле скорости \(u_{i1}\) между двумя некоаксиальными поверхностями:
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
    \label{fig:cylinders}
\end{figure}

%%% Velocity field
На рис.~\ref{fig:cylinders} представлены результаты численного моделирования для
\[ r = 2, \quad d = 0.5. \]
Течения между сферами (рис.~\ref{fig:cylinders-5}) и цилиндрами (рис.~\ref{fig:spheres-5}) имеют схожую структуру.
При возрастании \(\tau\) течение газа в широкой области усиливается быстрее, чем в узкой (рис.~\ref{fig:cylinders-50}),
а смена направления градиента температуры на противоположное разворачивает вихрь
в обратном направлении (рис.~\ref{fig:cylinders-inv}).

\begin{figure}[ht]
    \parbox[t]{0.48\linewidth}{%
        \centering
        \includegraphics{kgf/temper/U-tau-cylinders}
    }\hfill
    \parbox[t]{0.48\linewidth}{%
        \centering
        \includegraphics{kgf/force/terms-cylinder-inner-inv}
    }\\[-6pt]
    \parbox[t]{0.48\linewidth}{%
        \caption{Максимальная величина \(u_{i1}\) в зависимости от \(\tau\) при \(d=0.5\).
            Для малых \(\tau\) она пропорциональна \(\tau^3\), а для больших \(\tau\), она пропорциональна \(\tau^{3/2}\).}
        \label{fig:tau:maxU}
    }\hfill
    \parbox[t]{0.48\linewidth}{%
        \caption{Профиль компонентов действующей силы \(F_{x2}\) вдоль
            внутреннего цилиндра в полярных координатах при \(d=0.5\), \(T_1 = 5\) и \(T_2 = 1\).}
        \label{fig:terms:inner-swap}
    }
\end{figure}

% NTSF vs tau
Нелинейное термострессовое течение убывает как \(\OO{\tau^3}\) при малых \(\tau\) (рис.~\ref{fig:tau:maxU}),
поскольку температурный градиент включен в термострессовую силу в виде кубического члена (см.~\eqref{eq:kgf:gamma7_force}).
Поэтому, когда \(\tau^3\) становится сравнимым с \(k\), следует наравне учитывать эффекты
второго порядка по \(k\)~\cite{Sone1989Noncoaxial}.
С ростом \(\tau\) наклон кривой становится менее крутым,
так как вязкость газа твёрдых сфер растёт с температурой (рис.~\ref{fig:tau:maxU}).

%%% A force and how we evaluate it
Рассмотрим теперь силу, действующую на цилиндры.
Как указано ранее, \(p_{H2}\) определяется с точностью до константы
из уравнений КГФ~\eqref{eq:kgf:asymptotic1_u},~\eqref{eq:kgf:asymptotic1_T},~\eqref{eq:kgf:asymptotic2_p}.
Эта константа не вносит вклада в общую силу, действующую на тело,
но для определённости удельной силы на единицу площади необходимо наложить дополнительное условие
на \(p_{ijH2}\), например:
\begin{equation}\label{eq:dag_condition}
    \int p_{H2}^\dag\dx = 0.
\end{equation}

\begin{figure}[ht]
    \centering
    \subbottom[внешний цилиндр]{%
        \includegraphics[width=0.48\textwidth]{kgf/force/terms-cylinder-outer}
        \label{fig:terms:outer}}
    \subbottom[внутренний цилиндр]{%
        \includegraphics[width=0.48\textwidth]{kgf/force/terms-cylinder-inner}
        \label{fig:terms:inner}}
    \caption{Профиль компонентов действующей силы \(F_{x2}\) вдоль поверхности цилиндра
        в полярных координатах при \(d=0.5\) и \(\tau=4\).
        \(\varphi = -\pi/2\) соответствует точке~\(x=d-1\),
        \(\varphi = \pi/2\) соответствует точке~\(x=d+1\).}
    \label{fig:terms}
\end{figure}

%%% Force profiles
Вклад каждого члена~\eqref{eq:kgf:force} в общую величину действующей силы
показан на рис.~\ref{fig:terms:inner-swap} и~\ref{fig:terms}.
Отметим, что представленный профиль полного значения соответствует не реальному профилю силы \(F_{i2}\),
действующему на единицу площади, а только сумме всех членов в~\eqref{eq:kgf:force}.
Определение действующей силы в конкретной точке требует вычисления смешанных частных производных
второго порядка на границе, что является сложной задачей в используемом методе конечных объёмов.

\begin{figure}[ht]
    \centering
    \subbottom[внутренний цилиндр]{%
        \includegraphics[width=0.48\textwidth]{kgf/temper/F-tau-cylinders-inner}
        \label{fig:tau:force-inner}}
    \subbottom[внешний цилиндр]{%
        \includegraphics[width=0.48\textwidth]{kgf/temper/F-tau-cylinders-outer}
        \label{fig:tau:force-outer}}
    \caption{Полная сила, действующая на цилиндр, и её составляющие в зависимости от \(\tau\) при \(d=0.5\).}
    \label{fig:tau:force}
\end{figure}

%%% Total force vs tau
Для модели твёрдых сфер цилиндры притягиваются силой, пропорциональной \(\tau^2\)
как для больших, так и для малых \(\tau\) в соответствии с \eqref{eq:force_2bodies},
хотя отдельные компоненты не подчиняются этому соотношению (рис.~\ref{fig:tau:force-inner}, \ref{fig:tau:force-outer}).
Таким образом, положение \(d=0\) является неустойчивым равновесием.
Градиент температуры на внутреннем цилиндре растёт пропорционально \(\tau^{3/2}\),
но компенсируется гидростатическим давлением \(p^\dag_{H2}\) (рис.~\ref{fig:terms:inner}, \ref{fig:tau:force-inner}).
Вязкий член вносит лишь незначительный вклад в общую силу.
Если мы поменяем температуры \(T_1\) и \(T_2\) (рис.~\ref{fig:terms:inner-swap}),
полная сила, естественно, не меняет ни направления, ни своей величины.

\begin{figure}[ht]
    \centering
    \subbottom[пунктирные линии соответствуют линейному соотношению]{%
        \includegraphics[width=0.48\textwidth]{kgf/force/forces}
        \label{fig:forces:total}}
    \subbottom[пунктирные линии соответствуют степени \(3/2\) (1) для цилиндров (сфер)]{%
        \includegraphics[width=0.48\textwidth]{kgf/force/forces-close}
        \label{fig:forces:inverse}}
    \caption{Полная сила, действующая на внутренний цилиндр (сферу),
        в зависимости от расстоянием между их осями~\(d\)}
    \label{fig:forces:distance}
\end{figure}

%%% Electrostatic analogy and dependence of distance `d`
Как было указано в разделе~\ref{sect:asymptotic} сила притяжения подобна электростатической (см.~\eqref{eq:force_2bodies}),
а значит задача может быть рассмотрена как цилиндрический (сферический) конденсатор,
для которого известны выражения ёмкости~\cite{Smythe1954}:
\begin{equation}
    C_\mathrm{cyl} \propto \frac1{\theta}, \quad
    C_\mathrm{sph} \propto  \sum_{n=1}^\infty \frac{R_1 R_2 \sinh\theta} {R_2\sinh n\theta - R_1\sinh (n-1)\theta}, \quad
    \cosh\theta = \frac{R_1^2 + R_2^2 - d^2}{2 R_1 R_2}.
\end{equation}
Реальная зависимость силы притяжения от расстояния между телами представлена на рис.~\ref{fig:forces:distance}.

%\newpage
%============================================================================================================================
\section{Течение между двумя равномерно нагретыми эллиптическими цилиндрами} \label{sect:elliptic}

В последнем примере газ заключён между двумя равномерно нагретыми коаксиальными эллиптическими цилиндрами
расположенными так, что большие оси соответствующих эллипсов повёрнуты на угол \(\beta\).
Пусть малая полуось внешнего цилиндра является характерной длиной и расположена на оси \(y\),
в то время как большая полуось имеет длину \(a_1\) и лежит на оси \(x\).
Оси цилиндров находятся в центре координат \((x,y)\). Полуоси внутреннего эллипса равны \(a_0\) и \(b_0\).
Температура внутреннего цилиндра \(T_1 = 1\), а внешнего \(T_2 = 1+\tau\).
Далее рассмотрим задачу при следующих параметрах:
\[ a_1 = 1.5, \quad a_0 = 0.3, \quad b_0 = 0.7, \quad \tau = 4. \]
Результаты ПСМ разреженного газа в такой же геометрии при \(0.1\le\Kn\le5\) представлены в~\cite{Sone1998}.
В силу симметрии задачи при \(\beta=0\) и \(\beta=\pi/2\) достаточно рассмотреть первый квадрант (\(x>0\), \(y>0\)),
при остальных \(\beta\) расчётная область увеличивается вдвое (\(x>0\)).

При различных числах Кнудсена возникают несколько видов течений.
В континуальном пределе инфинитезимальное поле скоростей во всей области образует зав\'{и}хренность против часовой стрелки,
обусловленную нелинейной термострессовой конвекцией,
однако уже при \(\Kn>0.1\), наоборот, формируется течение по часовой стрелке,
которое доминирует над вихрем против часовой стрелки, находящимся в области,
наиболее удалённой от внутреннего цилиндра~\cite{Sone1998}.
Пристеночное течение по часовой стрелке образуется под действием тангенциального градиента температуры газа
на границе с диффузным отражением от равномерно нагретых цилиндров.
Особый интерес представляет процесс формирования указанного вихря по часовой стрелке
в зависимости от \(\Kn\), однако, ввиду того что поле скоростей убывает пропорционально \(\Kn\),
получение соответствующих картин конкурирующих течений представляет нетривиальную задачу
для численного анализа. В настоящем исследовании она решена с помощью КПИМДС.

\subsubsection{Решение задачи в континуальном пределе}

\begin{figure}
    \centering
    \includegraphics{kgf/elliptic/U}
    \caption{Поле скоростей \(u_{i1}\) между коаксиальными эллиптическими цилиндрами
        при а) \(\beta = \pi/2\) и б) \(\beta = \pi/4\):
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
    \label{fig:elliptic}
\end{figure}

\begin{figure}[ht]
    \parbox[t]{0.48\linewidth}{%
        \centering
        \includegraphics{kgf/moment/moment-beta}
    }\hfill
    \parbox[t]{0.48\linewidth}{%
        \centering
        \includegraphics{kgf/moment/profiles}
    }\\[-6pt]
    \parbox[t]{0.48\linewidth}{%
        \caption{Момент силы, действующей на внутренний эллиптический цилиндр,
            в зависимости от угла между большими осями цилиндров~\(\beta\) при \(\tau=4\).}
        \label{fig:elliptic:beta}
    }\hfill
    \parbox[t]{0.48\linewidth}{%
        \caption{Профиль суммы моментов отдельных составляющих силы \(M_{z2}\) вдоль внутреннего эллипса при \(\tau=4\).
            \(s=0\) и \(s=L_\mathrm{ell}/2\) соответствуют верхней (\(y>0\)) и нижней (\(y<0\)) точкам на оси ординат (\(x=0\)).
            \(L_\mathrm{ell}\) "--- периметр внутреннего эллипса.}
        \label{fig:elliptic:profiles}
    }
\end{figure}

На рис.~\ref{fig:elliptic} показано инфинитезимальное поле скоростей в континуальном пределе,
полученное путём численного решения уравнений КГФ.
Модуль этого поля максимален в области с наибольшим значением градиента температурного поля.

На рис.~\ref{fig:elliptic:beta} показан момент \(M_{i2} = e_{ijk}x_jF_{k2}\) силы,
действующей на единицу площади внутреннего цилиндра, в зависимости от угла поворота \(\beta\).
Полный момент равен нулю в симметричных случаях \(\beta=0\) и \(\beta=\pi/2\),
но только перпендикулярное состояние (\(\beta=\pi/2\)) устойчиво.
Соответствующие профили (в смысле, описанном в предыдущем параграфе) момента силы
вдоль внутреннего эллипса при разных \(\beta\) представлены на рис.~\ref{fig:elliptic:profiles}.

\subsubsection{Решение для произвольных чисел Кнудсена}

\begin{figure}
    \centering
    \subbottom[уравнения КГФ с граничными условиями первого порядка]{%
        \includegraphics{{{snit/elliptic/first-0.02-flow}}}
        \label{fig:elliptic:flow-first}}\\
    \subbottom[уравнения КГФ с граничными условиями второго порядка]{%
        \includegraphics{{{snit/elliptic/curv-0.02-flow}}}
        \label{fig:elliptic:flow-second}}
    \caption{Стационарное поле скоростей для \(\Kn=0.02\):
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
\end{figure}

\begin{figure}
    \centering
    \contsubbottom[уравнение Больцмана]{%
        \includegraphics{{{snit/elliptic/kes-0.02-flow}}}
        \label{fig:elliptic:flow-kes}}
    \contcaption{(продолжение) Стационарное поле скоростей для \(\Kn=0.02\):
        изолинии соответствуют модулю, кривые со стрелками изображают направление.}
    \label{fig:elliptic:flow}
\end{figure}

\begin{figure}
    \scalebox{0}{
        \begin{tikzpicture}
            \begin{axis}[hide axis]
                \addplot[line width=0.8, solid](0,0);       \label{leg:kes}
                \addplot[line width=0.8, dotted](0,0);      \label{leg:kgf}
                \addplot[line width=0.8, dashed](0,0);      \label{leg:first}
                \addplot[line width=0.8, dashdotted](0,0);  \label{leg:second}
            \end{axis}
        \end{tikzpicture}
    }%
    \centering
    \subbottom[внешний эллипс]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/outer_temp}
        \label{fig:profile-temp:outer}}
    \subbottom[внутренний эллипс]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/inner_temp}
        \label{fig:profile-temp:inner}}\\
    \subbottom[большая полуось внешнего эллипса]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/bottom_temp}
        \label{fig:profile-temp:bottom}}
    \subbottom[малая полуось внешнего эллипса]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/left_temp}
        \label{fig:profile-temp:left}}
    \hypersetup{hidelinks} % to prevent colorlinks
    \caption{
        Профиль граничной температуры. Угол \(\varphi\) соответствует полярным координатам
        \(x=r\cos\varphi\), \(y=r\sin\varphi\). \(T_{\mathrm{HCE}}\) "--- поле температуры,
        описываемое уравнением теплопроводности.
        Представлены следующие решения: уравнение Больцмана~\ref{leg:kes} (поделённое на \(1.0017\)),
        уравнения КГФ с граничными условиями ведущего порядка (только тепловое скольжение)~\ref{leg:kgf},
        первого~\ref{leg:first} и второго~\ref{leg:second} порядков.
    }
    \label{fig:profile-temp}
\end{figure}

\begin{figure}
    \centering
    \subbottom[внешний эллипс]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/outer_vel}
        \label{fig:profile-vel:outer}}
    \subbottom[внутренний эллипс]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/inner_vel}
        \label{fig:profile-vel:inner}}\\
    \subbottom[большая полуось внешнего эллипса]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/bottom_vel}
        \label{fig:profile-vel:bottom}}
    \subbottom[малая полуось внешнего эллипса]{%
        \includegraphics[width=.48\textwidth]{snit/profiles/left_vel}
        \label{fig:profile-vel:left}}
    \caption{
        Профиль тангенциальной скорости границе. Угол \(\varphi\) соответствует полярным координатам
        \(x=r\cos\varphi\), \(y=r\sin\varphi\). Единичный вектор \(t_i\) направлен против часовой стрелки.
        Представлены следующие решения: уравнение Больцмана~\ref{leg:kes},
        уравнения КГФ с тепловым скольжением~\ref{leg:kgf},
        с граничными условиями, содержащими только первые производные~\ref{leg:first},
        с граничными условиями, содержащими первые и вторые производные~\ref{leg:second}.
    }
    \label{fig:profile-vel}
\end{figure}

%%% Space discretization
Для численного решения задачи при \(\Kn=0.02\) в физическом пространстве
используется структурированная сетка, состоящая из \(N_V=2401\) четырёхугольных ячеек.
Она получается методом трансфинитной интерполяции с помощью пакета GMSH~\cite{gmsh}.
Направления продольных рёбер ячеек близки к касательным к изотермическим поверхностям,
а поперечных к градиенту температуры.
Вблизи цилиндрических поверхностей и особенно в области высокого градиента температур
сетка сгущается так, что минимальная ширина ячейки равна 0.046 длины свободного пробега.
В скоростном пространстве используется симметричная неравномерная сетка M4 (табл.~\ref{table:velocity_grids}),
в которой расстояние между узлами растёт квадратично вдоль каждой из осей.
Такая сетка позволяет удовлетворительно аппроксимировать функцию распределения
для широкого диапазона температур от \(T_1\) до \(T_2\).

%%% Information about consumed CPU time
Для нахождения стационарного решения уравнения Больцмана потребовалось \(10^5\) итераций,
при этом на каждом шаге использовалось \(5\cdot10^4\) кубатурных точек.
На персональном компьютере с CPU \(4\times3\)~GHz такой расчёт занял несколько суток.
На последних итерациях поля макроскопических величин усреднялись,
чтобы уменьшить шум, возникающий от циклического сдвига решётчатого правила Коробова
на случайный вектор.

%%% Results and discussions
На рис.~\ref{fig:elliptic:flow} изображены поля скорости, полученные различными методами.
Учёт скачков скорости и температуры первого порядка (рис.~\ref{fig:elliptic:flow-first})
качественно не меняет картину течения по сравнению с континуальным пределом (рис.~\ref{fig:elliptic}),
однако заметно понижает модуль скорости.
Граничные условия второго порядка, включая члены с тензором кривизны (рис.~\ref{fig:elliptic:flow-second}),
способны описать скольжение газа вдоль поверхностей цилиндров.
Численное решение уравнения Больцмана (рис.~\ref{fig:elliptic:flow-kes}),
однако, демонстрирует существенно отличную картину течения,
где наряду с термострессовой конвекцией против часовой стрелки возникает конкурирующий поток
в противоположном направлении. Этот поток наблюдается в области,
где градиент температуры и кривизна граничной поверхности максимальны, но вне кнудсеновского слоя,
поэтому он не может быть описан с помощью граничных условий.
Действительно, \(t_i\Pder[T_{H0}]{x_i}=0\) (\(t_i\) "--- единичный вектор касательный к границе),
поэтому на границе \(u_{iH1}=0\).
Термострессовое скольжение второго порядка сонаправлено с нелинейным термострессовым течением (\(a_4>0\)),
однако в следующем порядке члены, связанные с кривизной, пропорциональные \(\kappa t_i\Pder[T_{H1}]{x_i}\)
(\(\kappa\) "--- кривизна поверхности), уравновешивают пристеночное течение (\(\kappa(a_6+a_5/2)>0\)),
т.\,е. \(u_{iH2}t_i\) и \(u_{iH3}t_i\) имеют противоположные знаки.
Численный анализ с нелинейными граничными условиями не проводился,
поскольку коэффициент перед членом \((t_i\Pder[T_{H1}]{x_i})(n_j\Pder[T_{H0}]{x_j})\) неизвестен.

%%% Remark on strong variation of the solution
Как видно из рис.~\ref{fig:elliptic:flow}, асимптотическое решение ведущего порядка некорректно описывает
поле скоростей уже при \(\Kn=0.02\). Действительно, геометрия задачи приводит к образованию области,
где градиент температуры оказывается сравним не с единицей, а с обратным числом Кнудсена,
что означает \(kn_i\Pder[f]{x_i} = \OO{f}\), причём в отличие от слоя Кнудсена градиент спадает медленно.
Тем не менее асимптотическое решение действительно справедливо при малых \(\Kn\),
однако число Кнудсена должно определяться по наименьшему из характерных длин в задаче.
В рассмотренной задаче это не геометрические параметры (длина цилиндра или радиус кривизны),
а минимальное расстояние, где температура газа изменяется на единицу.
При таком определении число Кнудсена является функцией от разницы температур \(\tau\)
и зависимости коэффициента теплопроводности от температуры \(\Gamma_2(T)\).

%%% Extrapolation of the kesolver temperature field
Перед тем как сравнивать поля температур, уточним способ вычисления температуры
непосредственно на поверхностях цилиндров.
Дело в том, что численное решение уравнения Больцмана методом конечных объёмов
предоставляет значения функции распределения и макроскопических величин в центрах ячеек.
Поскольку в слое Кнудсена температура имеет слабую логарифмическую особенность,
то граничная температура вычисляется с помощью экстраполяции вида \(Ay\ln{y}+B\),
где \(A\) и \(B\) "--- константы, а \(y\) "--- расстояние от границы.
В предыдущих задачах линейной экстраполяции было достаточно,
поскольку ширина приграничной ячейки и градиент температуры были меньше.

%%% Comparison between solutions
Перейдём к рассмотрению рис.~\ref{fig:profile-temp} и~\ref{fig:profile-vel},
где показаны профили температуры и скорости на граничных поверхностях.
Использование температурного скачка первого порядка в граничных условиях
позволяет существенно улучшить асимптотическое поле температур,
в то время как температурный скачок следующего порядка является лишь малой поправкой.
Это связано с тем, что \(n_i\Pder[T_{H0}]{x_i}\) и \(n_in_j\Pderder[T_{H0}]{x_i}{x_j}\)
сравнимы, но гораздо больше \(T_{H0}\).
На рис.~\ref{fig:profile-temp} константное превышение численного решения над асимптотическим
в пределах \(0.004\) объясняется погрешностью кубатуры температуры,
однако на рис.~\ref{fig:profile-temp:left} и в области \(\varphi>\pi/3\) на рис.~\ref{fig:profile-temp:inner}
разница между решениями увеличивается из-за значительной разницы между скоростными полями \(v_i/k\),
влияющими на температурные поля через уравнение энергии~\eqref{eq:kgf:asymptotic1_T}.
Действительно, на рис.~\ref{fig:profile-vel:left} видно, что значение \((v_i/kT)\Pder[T]{x_i}\)
отличается даже знаком.
Граничные условия, содержащие вторые производные, позволяют лучше приблизить численное решение
на внешнем цилиндре (рис.~\ref{fig:profile-vel:outer}), но не на внутреннем (рис.~\ref{fig:profile-vel:inner}).
Как было указано выше, это связано с тем, что в области максимального градиента температуры
граничные условия для \(v_{iH3}\) в общем случае имеют порядок \(\OO{v_{iH2}/k}\),
но они не учтены при решении уравнений КГФ. Резкие колебания численного решения уравнения Больцмана
(особенно на рис.~\ref{fig:profile-vel:inner}) обусловлены погрешностью дискретизации в скоростном пространстве,
но не превышают \(10^{-4}\) по абсолютному значению \(u_i\).

\clearpage
